<?php
// Database credentials
$servername = "sql210.infinityfree.com";
$username = "if0_36720478";
$password = "VhjQkrL8A4KR6h1";
$dbname = "if0_36720478_BIKEYARD";

// Create connection
$conn = new mysqli($servername, $username, $password, $dbname);

// Check connection
if ($conn->connect_error) {
    die("Connection failed: " . $conn->connect_error);
}

// Process form submission if the form is submitted
if ($_SERVER["REQUEST_METHOD"] == "POST") {
    // Prepare data for insertion
    $name = $_POST['name'];
    $id = $_POST['id'];
    $phone = $_POST['phone'];
    $hours = isset($_POST['hours']) ? $_POST['hours'] : null;
    $cycleCode = $_POST['cycle_code'];
    $note = isset($_POST['note']) ? $_POST['note'] : null;
    $formType = $_POST['form_type'];

    // Prepare SQL statement based on form type
    if ($formType === 'book') {
        $sql = "INSERT INTO bookings (name, id, phone, hours, cycle_code, note) 
                VALUES ('$name', '$id', '$phone', '$hours', '$cycleCode', '$note')";
    } elseif ($formType === 'repair') {
        $sql = "INSERT INTO repairs (name, cycle_code, problem) 
                VALUES ('$name', '$cycleCode', '$note')";
    } else {
        die("Invalid form submission.");
    }

    // Execute SQL statement
    if ($conn->query($sql) === TRUE) {
        echo "New record created successfully";
        // Redirect back to index.html or provide a success message
        // header("Location: index.html"); // Uncomment to redirect back
    } else {
        echo "Error: " . $sql . "<br>" . $conn->error;
    }
} else {
    echo "Form submission method not allowed.";
}

// Close connection
$conn->close();
?>
