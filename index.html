<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bike Yard App</title>
  <style>
    /* Your CSS styles */
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
</head>
<body>
  <header>
    <div class="dashboard">
      <img src="https://img.icons8.com/ios-filled/50/000000/bicycle.png" alt="Bike Logo">
      <h1>Bike Yard Owner Dashboard</h1>
    </div>
  </header>
  <div class="container">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRLLU40gx6sGv6dKhbyc4AOVtlDFVVetXmpyg&s" alt="Background" class="background-image">
    
    <div class="button-container">
      <button id="bookBtn" onclick="showBookForm()">Book</button>
      <button id="repairBtn" onclick="showRepairForm()">Repair</button>
      <button id="exportBtn" onclick="exportData()">Export Data</button>
    </div>

    <form id="bikeForm" style="display: none;" action="http://bikeyard1.000.pe/connect.php" method="post" enctype="multipart/form-data">
      <input type="text" id="name" placeholder="Name" required name="name">
      <input type="text" id="id" placeholder="ID" required name="id">
      <input type="text" id="phone" placeholder="Phone Number" required name="phone">
      <input type="number" id="hours" placeholder="hours" name="hours">
      <input type="text" id="cycleCode" placeholder="Cycle Code" required name="cycle_code">
      <textarea id="note" placeholder="Note" class="note" style="display: none;" name="note"></textarea>
      <input type="hidden" name="form_type" id="form_type">
      <div id="errorMessage"></div>
      <button type="submit" id="submitBtn">Submit</button>
    </form>
  </div>

  <script>
    let submittedData = [];
    let currentType = '';

    function showBookForm() {
      currentType = 'Book';
      document.getElementById('form_type').value = 'book';
      document.getElementById('bikeForm').style.display = 'block';
      document.getElementById('name').style.display = 'block';
      document.getElementById('id').style.display = 'block';
      document.getElementById('phone').style.display = 'block';
      document.getElementById('hours').style.display = 'block';
      document.getElementById('cycleCode').style.display = 'block';
      document.getElementById('note').style.display = 'block';
      document.getElementById('note').placeholder = 'Note (optional)';
      document.getElementById('name').focus();
      document.getElementById('errorMessage').innerHTML = '';
    }

    function showRepairForm() {
      currentType = 'Repair';
      document.getElementById('form_type').value = 'repair';
      document.getElementById('bikeForm').style.display = 'block';
      document.getElementById('name').style.display = 'block';
      document.getElementById('id').style.display = 'none';
      document.getElementById('phone').style.display = 'none';
      document.getElementById('hours').style.display = 'none';
      document.getElementById('cycleCode').style.display = 'block';
      document.getElementById('note').style.display = 'block';
      document.getElementById('note').placeholder = 'Problem';
      document.getElementById('name').focus();
      document.getElementById('errorMessage').innerHTML = '';
    }

    function exportData() {
      const wb = XLSX.utils.book_new();

      const bookData = submittedData.filter(data => data.type === 'Book');
      const repairData = submittedData.filter(data => data.type === 'Repair');

      const wsBookData = bookData.map(data => [data.name, data.id, data.phone, data.hours, data.cycleCode, data.note]);
      const wsRepairData = repairData.map(data => [data.name, data.cycleCode, data.note]);

      const wsBook = XLSX.utils.aoa_to_sheet([['Name', 'ID', 'Phone Number', 'Hours', 'Cycle Code', 'Note'], ...wsBookData]);
      const wsRepair = XLSX.utils.aoa_to_sheet([['Name', 'Cycle Code', 'Problem'], ...wsRepairData]);

      XLSX.utils.book_append_sheet(wb, wsBook, 'Bookings');
      XLSX.utils.book_append_sheet(wb, wsRepair, 'Repairs');

      XLSX.writeFile(wb, 'bike_yard_data.xlsx');
    }
  </script>
</body>
</html>
